(this["webpackJsonpoverlay-react"]=this["webpackJsonpoverlay-react"]||[]).push([[0],{34:function(e,t,n){e.exports=n(68)},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(25),i=n.n(c),l=(n(39),n(1)),o=(n(40),n(6)),u=/[?&]OVERLAY_WS=([^&]+)/.exec(window.location.href),s=null,m=[],f={},v={},d=null,p=!1;if(u){d=function(e){m?m.push(e):s.send(JSON.stringify(e))},function e(){(s=new WebSocket(u[1])).addEventListener("error",(function(e){console.error(e)})),s.addEventListener("open",(function(){console.log("Connected!");var e=m;m=null;var t,n=Object(o.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;d(a)}}catch(r){n.e(r)}finally{n.f()}})),s.addEventListener("message",(function(e){try{e=JSON.parse(e.data)}catch(t){return void console.error("Invalid message received: ",e)}void 0!==e.rseq&&f[e.rseq]?(f[e.rseq](e),delete f[e.rseq]):E(e)})),s.addEventListener("close",(function(){m=[],console.log("Trying to reconnect..."),setTimeout((function(){e()}),300)}))}()}else{d=function(e,t){m?m.push([e,t]):OverlayPluginApi.callHandler(JSON.stringify(e),t)},function e(){if(window.OverlayPluginApi&&window.OverlayPluginApi.ready){var t=m;m=null,window.__OverlayCallback=E;var n,a=Object(o.a)(t);try{for(a.s();!(n=a.n()).done;){var r=Object(l.a)(n.value,2),c=r[0],i=r[1];d(c,i)}}catch(u){a.e(u)}finally{a.f()}}else setTimeout(e,300)}()}function E(e){if(v[e.type]){var t,n=Object(o.a)(v[e.type]);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(a){n.e(a)}finally{n.f()}}}var g=n(26),h=n(31);function y(e){var t=e.innerFill,n=void 0===t?"#fffc":t,a=e.style,c=void 0===a?{height:30,backgroundColor:"#b7ca32",borderRadius:"50%"}:a,i=Object(h.a)(e,["innerFill","style"]);return r.a.createElement("svg",Object.assign({className:"logo",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 400 400",style:c},i),r.a.createElement("path",{d:"M197.64,360c15.85-88.59-111.9-66.21-111.9-204.22,4.87,7.3,23.25,24.28,23.63,24.56,42.09,30,93.87,15.56,93.87,99.47,0-98.85,88.59-103.51,88.59-188.37C370.15,236.91,220,283.53,197.64,360Zm6.53-116.56c0-84.86,52.22-73.67,52.22-125.89C256.39,83,234.94,60,214,60c-30.32,0-30.32,40.76-30.32,74.33,0-28-15.85-65.21-35.28-65.21C123,69.12,123,104.49,123,114.75,123,185.62,204.17,186.55,204.17,243.44Z",fill:n}))}function b(e){var t=e.children,n=e.onClick,c=Object(a.useState)(0),i=Object(l.a)(c,2),o=i[0],u=i[1];return r.a.Children.map(t,(function(e){return r.a.cloneElement(e,{onMouseDown:function(){u(Date.now())},onMouseUp:function(){Date.now()-o<100&&n()}})}))}var O=n(15),j=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];function w(e){var t=[1,2,3,4,5,6,7,8,9].filter((function(t){return!e.includes(t)}));if(t.length>5)throw new Error("\u8bf7\u586b\u5199 4 \u4e2a\u6570\u5b57");var n=function(e){var t=[];return function e(n){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0;r<n.length;r++){var c=n.splice(r,1);0===n.length&&t.push(a.concat(c)),e(n.slice(),a.concat(c)),n.splice(r,0,c[0])}return t}(e)}(t).map((function(t){var n=0;return e.map((function(e){return 0===e?t[n++]:e}))}));return j.map((function(e){var t=n.reduce((function(t,n){return t+function(e,t){var n=t.reduce((function(t,n){return t+e[n]}),0);return N[n]}(n,e)}),0);return Math.floor(t/n.length)}))}var N=[0,0,0,0,0,0,1e4,36,720,360,80,252,108,72,54,180,72,180,119,36,306,1080,144,1800,3600];function C(e){var t=e.max,n=e.value;return r.a.createElement("th",{className:t===n?"cactpot-max":""},r.a.createElement("span",null,n||"\xa0"))}function q(e){var t=e.value,n=e.highlight,a=0===t;return r.a.createElement("td",null,r.a.createElement("span",{className:"cactpot-input".concat(a?" unknown":"").concat(n?" highlight":"")},t||" "))}function S(e){var t=e.input,n=t.reduce((function(e,t){return e+(t?1:0)}),0),c=Object(a.useMemo)((function(){return n<4?[]:w(t)}),[n,t]),i=Object(a.useMemo)((function(){return c.reduce((function(e,t){return Math.max(e,t)}),0)}),[c]),l=Object(a.useMemo)((function(){var e=[];return c.forEach((function(t,n){t===i&&j[n].forEach((function(t){e[t]=!0}))})),e}),[c,i]);return r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,[6,3,4,5,7].map((function(e){return r.a.createElement(C,{key:e,max:i,value:c[e]})}))),[0,1,2].map((function(e){return r.a.createElement("tr",{key:e},r.a.createElement(C,{max:i,value:c[e]}),[0,1,2].map((function(n){var a=3*e+n;return r.a.createElement(q,{key:n,highlight:l[a],value:t[a]})})))}))))}n(41);var k=function(){return[0,0,0,0,0,0,0,0,0]};var M=n(11),x=n(2),A=n(13),P=n(27),T=n(28),I=n(5),_=n(32),J=n(33),L=n(30),D=n(12),R=n(29),W=function(e){Object(J.a)(n,e);var t=Object(L.a)(n);function n(e){var a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(P.a)(this,n),(a=t.call(this,Object(A.a)({},r,{dispose:function(e,t){a.saveToStorage(),r.dispose&&r.dispose(e,t)}}))).name=e,a.saveToStorage=Object(D.debounce)((function(){window.localStorage&&window.localStorage.setItem(a.name,JSON.stringify(a.dump()))}),200),a.loadFromStorage(),a}return Object(T.a)(n,[{key:"loadFromStorage",value:function(){if(window.localStorage){var e=window.localStorage.getItem(this.name);if(e)try{this.load(JSON.parse(e))}catch(t){}}}},{key:"set",value:function(e,t,a){var r=Object(_.a)(Object(I.a)(n.prototype),"set",this).call(this,e,t,a);return this.saveToStorage(),r}}]),n}(n.n(R).a);function B(){return r.a.createElement("svg",{className:"hq-icon",viewBox:"0 0 64 67",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M41.1148 9.7149C50.538 9.7149 58.8813 14.3384 64 21.4405C59.3004 8.91467 47.2153 0 33.048 0C14.7961 0 0 14.7961 0 33.048C0 51.2999 14.7961 66.0959 33.048 66.0959C34.469 66.0959 35.8691 66.0062 37.2428 65.8322C33.4767 65.3149 29.9478 64.0537 26.8091 62.2016C25.2784 60.1233 24.3739 57.5554 24.3739 54.7763C24.3739 47.854 29.9856 42.2424 36.9079 42.2424C43.4076 42.2424 48.7518 47.1898 49.3801 53.5242C50.0936 51.5602 50.4827 49.4405 50.4827 47.23C50.4827 37.0501 42.2303 28.7977 32.0504 28.7977C22.6912 28.7977 14.9612 35.7732 13.7757 44.8089C13.2197 42.5998 12.9243 40.2871 12.9243 37.9054C12.9243 22.3362 25.5456 9.7149 41.1148 9.7149Z",fill:"white"}))}var F=n(14),Z=n.n(F),G=["","\u60f0\u6027","\u521a\u529b","\u8010\u529b","\u5de7\u529b","\u667a\u529b","\u610f\u529b","\u4fe1\u529b","\u521b\u706b","\u521b\u51b0","\u521b\u98ce","\u521b\u571f","\u521b\u96f7","\u521b\u6c34","\u795e\u773c","\u6b66\u7565","\u96c4\u7565","\u521a\u67d4","\u8fbe\u8bc6","\u535a\u8bc6","\u5668\u8bc6","\u540d\u5320","\u9b54\u5320","\u5de8\u5320","\u6218\u6280","\u548f\u5531"],H="https://cafemaker.wakingsands.com",U=new W("gearset-item"),V=[],Y=Object(D.debounce)((function(){var e=V.slice();V=[];var t=e.map((function(e){return e.id})).join("%2C");Z.a.get("".concat(H,"/item?columns=ID%2CIcon%2CMateriaSlotCount%2CIsAdvancedMeldingPermitted&ids=").concat(t)).then((function(t){var n,a=Object(o.a)(t.data.Results);try{for(a.s();!(n=a.n()).done;)for(var r=n.value,c={i:r.Icon,s:r.MateriaSlotCount,a:r.IsAdvancedMeldingPermitted},i=0;i<e.length;)e[i].id===r.ID?(e[i].resolve(c),e.splice(i,1)):++i}catch(l){a.e(l)}finally{a.f()}e.forEach((function(e){return e.resolve()}))})).catch((function(t){e.forEach((function(e){return e.reject(t)}))}))}),500);function $(e){var t=e.part,n=Object(a.useState)(),c=Object(l.a)(n,2),i=c[0],o=c[1],u=t&&t.item&&t.item.id;if(Object(a.useEffect)((function(){if(u){var e=U.get(u);if(!e){var t,n=Z.a.CancelToken.source();return(t=u,new Promise((function(e,n){V.push({id:t,resolve:e,reject:n}),Y()}))).then((function(e){U.set(u,e),o(e)})).catch((function(){})),function(){n.cancel()}}o(e)}}),[u]),!t||!t.item)return r.a.createElement("div",{className:"gearset-item gearset-item-empty"},"\u7a7a\u680f\u4f4d");for(var s=i?i.s:5,m=t.materias.map((function(e,t){var n=e.id,a=e.tier;return{icon:"icon/materia/slot_".concat(t>=s?"overmeld":"normal","_grade0").concat(a,".png"),name:"".concat(G[n],"\u9b54\u6676\u77f3").concat("\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c"[a],"\u578b")}})),f=i&&i.a?5:s,v=m.length;v<f;++v)m.push({icon:"icon/materia/slot_".concat(v>=s?"overmeld":"normal","_empty.png"),name:"\u672a\u9576\u5d4c"});return r.a.createElement("div",{className:"gearset-item"},r.a.createElement("div",{className:"gearset-item-icon"},i?r.a.createElement("img",{alt:t.item.name,src:"".concat(H).concat(i.i)}):null),t.glamour?r.a.createElement("div",{className:"gearset-item-name gearset-item-name-animated"},r.a.createElement("span",null,t.item.name," ",t.hq?r.a.createElement(B,null):null),r.a.createElement("span",{className:"delay"},t.glamour.name)):r.a.createElement("div",{className:"gearset-item-name"},t.item.name," ",t.hq?r.a.createElement(B,null):null),r.a.createElement("div",{className:"gearset-item-materia"},m.map((function(e){var t=e.name,n=e.icon;return r.a.createElement("img",{alt:t,src:n})}))))}n(65);function z(e){var t=e.title,n=e.list;return r.a.createElement("div",{className:"gearset-wrap"},r.a.createElement("h3",null,t),n.isEmpty()?r.a.createElement("div",{className:"gearset-empty"},"\u6682\u65e0\u914d\u88c5\u6570\u636e"):r.a.createElement("div",{className:"gearset-container"},r.a.createElement("div",{className:"gearset-left"},[0,2,3,4,5,6,7].map((function(e){return r.a.createElement($,{key:e,part:n.get(e)})}))),r.a.createElement("div",{className:"gearset-right"},[1,8,9,10,11,12,13].map((function(e){return r.a.createElement($,{key:e,part:n.get(e)})})))))}n(66);var K=Object(x.c)({price:0,quantity:0,hq:0}),Q=Object(x.c)({id:0,name:"",rows:Object(x.b)()});n(67);function X(e){var t=e.quantity,n=e.hq;return r.a.createElement("span",{className:"quantity"},"(",(t-n).toLocaleString(),"/",r.a.createElement(B,null),n.toLocaleString(),")")}function ee(e){var t=e.server,n=e.item,a=n.get("rows").get(t.id);if(!a||0===a.count())return r.a.createElement("td",{className:"no-record"},"-");var c=a.get(0).toJS(),i=a.reduce((function(e,t){if(e.quantity>=99)return e;var n=t.get("quantity");return{totalPrice:e.totalPrice+t.get("price")*n,quantity:e.quantity+n,hq:e.hq+t.get("hq")}}),{totalPrice:0,quantity:0,hq:0}),l=n.get("rows").every((function(e){var t=e.get(0);return!t||t.get("price")>=c.price}));return r.a.createElement("td",{className:l?"lowest":""},r.a.createElement("div",{className:"single"},c.price.toLocaleString(),r.a.createElement(X,{quantity:c.quantity,hq:c.hq})),r.a.createElement("div",{className:"group"},"~",(i.totalPrice/i.quantity).toLocaleString(void 0,{maximumFractionDigits:0}),r.a.createElement(X,{quantity:i.quantity,hq:i.hq})))}function te(e,t){return t.reduce((function(e,t){var n=Object(l.a)(t,3),a=n[0],r=n[1],c=n[2],i=e.findIndex((function(e){return e.get("price")===a}));return-1===i?e.push(K({price:a,quantity:r,hq:c?r:0})):e.update(i,(function(e){return e.update("quantity",(function(e){return e+r})).update("hq",(function(e){return e+(c?r:0)}))}))}),e)}function ne(){return r.a.createElement("div",{style:{padding:"0 10px"}},r.a.createElement("p",null,"\u68c0\u6d4b\u5230\u60a8\u53ef\u80fd\u542f\u7528\u4e86 ACTWS \u517c\u5bb9\u6a21\u5f0f\uff0c\u5728\u6b64\u6a21\u5f0f\u4e0b\u672c\u9875\u9762\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002\u8bf7\u5c1d\u8bd5\u901a\u8fc7\u4ee5\u4e0b\u64cd\u4f5c\u8fdb\u884c\u4fee\u590d"),r.a.createElement("ol",null,r.a.createElement("li",null,"\u5728",r.a.createElement("span",{className:"tag"},"ngld \u60ac\u6d6e\u7a97\u63d2\u4ef6"),"\u4e2d\u627e\u5230\u672c\u60ac\u6d6e\u7a97"),r.a.createElement("li",null,"\u53d6\u6d88\u9009\u4e2d",r.a.createElement("span",{className:"tag"},"ACTWS"),"\u9009\u9879\u5361\u4e0b",r.a.createElement("span",{className:"tag"},"ACTWS \u517c\u5bb9\u6027"),"\u590d\u9009\u6846"),r.a.createElement("li",null,"\u79fb\u9664",r.a.createElement("span",{className:"tag"},"\u901a\u7528"),"\u9009\u9879\u5361\u4e0b\u60ac\u6d6e\u7a97\u8def\u5f84\u4e2d\u7684",r.a.createElement("code",{className:"tag query"},window.location.search))))}ee.Empty=function(){return r.a.createElement("td",null,r.a.createElement("div",{className:"single"},"\u6700\u4f4e\u4ef7",r.a.createElement(X,{quantity:1,hq:0})),r.a.createElement("div",{className:"group"},"\u524d N \u4e2a\u5747\u4ef7",r.a.createElement(X,{quantity:10,hq:2})))};var ae={welcome:{title:null,Component:function(){return r.a.createElement("div",null)}},market:{title:"\u7269\u4ef7\u5bf9\u6bd4",Component:function(e){var t=e.eventEmitter,n=e.active,c=e.setActive,i=Object(a.useState)(Object(x.a)()),o=Object(l.a)(i,2),u=o[0],s=o[1],m=Object(a.useState)(Object(x.a)()),f=Object(l.a)(m,2),v=f[0],d=f[1],p=function(){s((function(e){return e.clear()})),d((function(e){return e.clear()}))};return Object(a.useEffect)((function(){var e=function(e){var t=function(e){if("$"===e[0])return{type:"command",command:e.substr(1)};try{var t=JSON.parse(e),n=Object(M.a)(t);return{type:"data",mode:n[0],server:{id:n[1],name:n[2]},item:{id:n[3],name:n[4]},data:n.slice(5)}}catch(a){return null}}(e.content);null!==t&&(n||c(),"command"===t.type?"reset"===t.command&&p():"data"===t.type&&(s((function(e){return e.find((function(e){return e.id===t.server.id}))?e:e.push(t.server)})),d((function(e){var n=e.findIndex((function(e){return e.get("id")===t.item.id}));return-1===n?"data"!==t.mode?e:e.push(Q(Object(A.a)({},t.item,{rows:Object(x.b)().set(t.server.id,te(Object(x.a)(),t.data))}))):e.update(n,(function(e){return e.update("rows",(function(e){return"count"===t.mode?e.set(t.server.id,Object(x.a)()):e.has(t.server.id)?e.update(t.server.id,(function(e){return te(e,t.data)})):e.set(t.server.id,te(Object(x.a)(),t.data))}))}))}))))};return t.on("MarketBoard",e),function(){t.off("MarketBoard",e)}}),[n,t,c]),n?r.a.createElement("table",{className:"overlay-market"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{width:75}},r.a.createElement("button",{className:"button",onClick:p},"\u91cd\u7f6e")),v.isEmpty()?r.a.createElement("th",null,"\u7269\u54c1\u540d"):v.map((function(e){var t=e.get("name");return r.a.createElement("th",{key:e.get("id"),className:t.length>=6?"small":""},t)})))),r.a.createElement("tbody",null,u.isEmpty()?r.a.createElement("tr",null,r.a.createElement("th",null,"\u670d\u52a1\u5668"),r.a.createElement(ee.Empty,null)):u.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("th",null,e.name),v.isEmpty()?r.a.createElement(ee.Empty,null):v.map((function(t){return r.a.createElement(ee,{key:"".concat(e.id,"-").concat(t.get("id")),server:e,item:t})})))})))):null}},gearset:{title:"\u914d\u88c5\u6bd4\u8f83",Component:function(e){var t=e.eventEmitter,n=e.active,c=e.setActive,i=Object(a.useState)(Object(x.a)()),o=Object(l.a)(i,2),u=o[0],s=o[1],m=Object(a.useState)(Object(x.a)()),f=Object(l.a)(m,2),v=f[0],d=f[1];return Object(a.useEffect)((function(){var e=function(e){var t=function(e){try{for(var t=JSON.parse(e),n=Object(M.a)(t),a=n[0],r=n[1],c=n[2],i=n[3],l=n[4],o=n[5],u=n[6],s=n.slice(7),m=[],f=0;f<5&&s[2*f];++f)m.push({id:s[2*f],tier:s[2*f+1]});return{type:a,slot:r,item:c?{id:c,name:i}:null,hq:1===l,glamour:o?{id:o,name:u}:null,materias:m}}catch(v){return}}(e.content);t&&(n||c(),(0===t.type?s:d)((function(e){return e.set(t.slot,t)})))};return t.on("Gearset",e),function(){t.off("Gearset",e)}}),[n,t,c]),n?r.a.createElement("div",{className:"overlay overlay-gearset"},r.a.createElement(z,{title:"\u6211\u7684\u88c5\u5907",list:u}),r.a.createElement(z,{title:"\u4ed6\u4eba\u88c5\u5907",list:v})):null}},cactpot:{title:"\u4ed9\u4eba\u5fae\u5f69",Component:function(e){var t=e.eventEmitter,n=e.active,c=e.setActive,i=Object(a.useState)(k),o=Object(l.a)(i,2),u=o[0],s=o[1];return Object(a.useEffect)((function(){var e=function(e){var t=function(e){try{var t=JSON.parse(e),n=Object(l.a)(t,4),a=n[0],r=n[1],c=n[2],i=n[3];return{isNew:1===a,column:Math.max(0,Math.min(2,r)),row:Math.max(0,Math.min(2,c)),value:Math.max(1,Math.min(9,i))}}catch(o){return}}(e.content);if(t){n||c();var a=3*t.row+t.column;s((function(e){return t.isNew&&(e=[0,0,0,0,0,0,0,0,0]),[].concat(Object(O.a)(e.slice(0,a)),[t.value],Object(O.a)(e.slice(a+1)))}))}};return t.on("Cactpot",e),function(){t.off("Cactpot",e)}}),[n,t,c]),Object(a.useEffect)((function(){var e=function(e){return t.emit("Cactpot",e)};setTimeout((function(){e({type:"cactpot",version:"",content:"[1,2,1,7]"}),e({type:"cactpot",version:"",content:"[0,2,0,4]"}),e({type:"cactpot",version:"",content:"[0,1,1,5]"}),e({type:"cactpot",version:"",content:"[0,0,2,9]"})}),10)}),[t]),n?r.a.createElement("div",{className:"overlay overlay-cactpot"},r.a.createElement(S,{input:u})):null}}};var re=function(){var e=-1!==window.location.search.indexOf("HOST_PORT"),t=Object(a.useMemo)((function(){return new g.EventEmitter}),[]),n=Object(a.useState)(!1),c=Object(l.a)(n,2),i=c[0],o=c[1],u=Object(a.useState)("market"),s=Object(l.a)(u,2),m=s[0],f=s[1];return Object(a.useEffect)((function(){e?window.__OverlayPlugin_ws_faker=function(){}:(!function(e,t){p&&v[e]&&console.warn("A new listener for ".concat(e," has been registered after event transmission has already begun.\nSome events might have been missed and no cached values will be transmitted.\nPlease register your listeners before calling startOverlayEvents().")),v[e]||(v[e]=[]),v[e].push(t)}("LogLine",(function(e){var n=e.line;if(n&&5===n.length&&"00"===n[0]){var a=n[3];if(a.startsWith("Matcha")){var r=a.indexOf("-");if(-1!==r){var c=a.substr(r+1),i=a.indexOf("#"),l={type:c,version:-1===i?"5.1.5.1":a.substr(i+1,r-i-1),content:n[4]};console.log(l),t.emit(c,l)}}}})),p=!1,d({call:"subscribe",events:Object.keys(v)}))}),[t,e]),i?r.a.createElement("div",{className:"app app-minified"},r.a.createElement(b,{onClick:function(){return o(!1)}},r.a.createElement(y,null))):r.a.createElement("div",{className:"app app-wrap"},r.a.createElement("header",{className:"header"},r.a.createElement(b,{onClick:function(){return o(!0)}},r.a.createElement("span",null,r.a.createElement(y,null))),e?null:Object.entries(ae).map((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1].title;return a&&r.a.createElement(b,{key:n,onClick:function(){return f(n)}},r.a.createElement("span",{className:n===m?"tab active":"tab"},a))}))),e?r.a.createElement(ne,null):Object.entries(ae).map((function(e){var n=Object(l.a)(e,2),a=n[0],c=n[1].Component;return r.a.createElement(c,{key:a,eventEmitter:t,active:a===m,setActive:function(){return f(a)}})})))};i.a.render(r.a.createElement(re,null),document.getElementById("root"))}},[[34,1,2]]]);