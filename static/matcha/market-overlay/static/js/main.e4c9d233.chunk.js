(this["webpackJsonpmarket-overlay-react"]=this["webpackJsonpmarket-overlay-react"]||[]).push([[0],{11:function(e,t,n){e.exports=n(18)},16:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(8),i=n.n(c),u=(n(16),n(3)),o=n(9),l=n(4),s=n(10),d=(n(17),/[\?&]OVERLAY_WS=([^&]+)/.exec(window.location.href)),f=null,m=[],v={},y={},g=null,h=!1;if(d){g=function(e){m?m.push(e):f.send(JSON.stringify(e))},function e(){(f=new WebSocket(d[1])).addEventListener("error",(function(e){console.error(e)})),f.addEventListener("open",(function(){console.log("Connected!");var e=m;m=null;var t,n=Object(u.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;g(r)}}catch(a){n.e(a)}finally{n.f()}})),f.addEventListener("message",(function(e){try{e=JSON.parse(e.data)}catch(t){return void console.error("Invalid message received: ",e)}void 0!==e.rseq&&v[e.rseq]?(v[e.rseq](e),delete v[e.rseq]):p(e)})),f.addEventListener("close",(function(){m=[],console.log("Trying to reconnect..."),setTimeout((function(){e()}),300)}))}()}else{g=function(e,t){m?m.push([e,t]):OverlayPluginApi.callHandler(JSON.stringify(e),t)},function e(){if(window.OverlayPluginApi&&window.OverlayPluginApi.ready){var t=m;m=null,window.__OverlayCallback=p;var n,r=Object(u.a)(t);try{for(r.s();!(n=r.n()).done;){var a=Object(l.a)(n.value,2),c=a[0],i=a[1];g(c,i)}}catch(o){r.e(o)}finally{r.f()}}else setTimeout(e,300)}()}function p(e){if(y[e.type]){var t,n=Object(u.a)(y[e.type]);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(r){n.e(r)}finally{n.f()}}}var b=n(1),O=Object(b.b)({price:0,quantity:0,hq:0}),q=Object(b.b)({server:0,records:Object(b.a)()}),E=Object(b.b)({id:0,name:"",rows:Object(b.a)()}),w="00:0000:Matcha-MarketBoard:";function j(e,t){return t.reduce((function(e,t){var n=Object(l.a)(t,3),r=n[0],a=n[1],c=n[2];return e.update("records",(function(t){var n=e.get("records").findIndex((function(e){return e.get("price")===r}));return-1===n?t.push(O({price:r,quantity:a,hq:c?a:0})):t.update(n,(function(e){return e.update("quantity",(function(e){return e+a})).update("hq",(function(e){return e+(c?a:0)}))}))}))}),e)}var N=function(){var e=Object(r.useState)(Object(b.a)()),t=Object(l.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(Object(b.a)()),d=Object(l.a)(i,2),f=d[0],m=d[1];return Object(r.useEffect)((function(){var e,t,n=function(e){var t=function(e){var t=e.indexOf(" ");if(-1===t)return null;if(e.substr(t+1,w.length)!==w)return null;var n=e.substr(t+1+w.length);if("$"===n[0])return{type:"command",command:n.substr(1)};try{var r=JSON.parse(n),a=Object(s.a)(r);return{type:"data",mode:a[0],server:{id:a[1],name:a[2]},item:{id:a[3],name:a[4]},data:a.slice(5)}}catch(c){return null}}(e);null!==t&&("command"===t.type?"reset"===t.command&&(c((function(e){return e.clear()})),m((function(e){return e.clear()}))):"data"===t.type&&(c((function(e){return e.find((function(e){return e.id===t.server.id}))?e:e.push(t.server)})),m((function(e){var n=e.findIndex((function(e){return e.get("id")===t.item.id}));return-1===n?"data"!==t.mode?e:e.push(E(Object(o.a)({},t.item,{rows:Object(b.a)([j(q({server:t.server.id}),t.data)])}))):e.update(n,(function(e){return e.update("rows",(function(e){var n=e.findIndex((function(e){return e.get("server")===t.server.id}));return-1===n?"data"!==t.mode?e:e.push(j(q({server:t.server.id}),t.data)):"count"===t.mode?e.update(n,(function(e){return e.remove("records")})):e.update(n,(function(e){return j(e,t.data)}))}))}))}))))};e="onLogEvent",t=function(e){if(e.detail&&e.detail.logs){var t,r=Object(u.a)(e.detail.logs);try{for(r.s();!(t=r.n()).done;){var a=t.value;n(a)}}catch(c){r.e(c)}finally{r.f()}}},h&&y[e]&&console.warn("A new listener for ".concat(e," has been registered after event transmission has already begun.\nSome events might have been missed and no cached values will be transmitted.\nPlease register your listeners before calling startOverlayEvents().")),y[e]||(y[e]=[]),y[e].push(t),h=!1,g({call:"subscribe",events:Object.keys(y)})}),[]),a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",{className:"logo",style:{width:100}},"Matcha"),f.map((function(e){return a.a.createElement("th",{key:e.get("id")},e.get("name"))})))),a.a.createElement("tbody",null,n.map((function(e){return a.a.createElement("tr",{key:e.id},a.a.createElement("th",null,e.name),f.map((function(t){var n="".concat(e.id,"-").concat(t.get("id")),r=t.get("rows").find((function(t){return console.log(t),t.get("server")===e.id}));if(!r||0===r.get("records").count())return a.a.createElement("td",{key:n,className:"no-record"},"-");var c=r.get("records"),i=c.get(0).toJS(),u=c.reduce((function(e,t){if(e.quantity>=99)return e;var n=t.get("quantity");return{totalPrice:e.totalPrice+t.get("price")*n,quantity:e.quantity+n,hq:e.hq+t.get("hq")}}),{totalPrice:0,quantity:0,hq:0}),o=t.get("rows").every((function(t){if(t.get("server")===e.id)return!0;var n=t.get("records").get(0);return!n||n.get("price")>=i.price}));return a.a.createElement("td",{key:n,className:o?"lowest":""},a.a.createElement("div",{className:"single"},i.price.toLocaleString(),a.a.createElement("span",{className:"quantity"},"[",i.quantity,i.hq?a.a.createElement("span",{className:"hq"},"(",i.hq,a.a.createElement("img",{src:"hq-white",alt:"HQ"}),")"):null,"]")),a.a.createElement("div",{className:"group"},(u.totalPrice/u.quantity).toLocaleString(void 0,{maximumFractionDigits:0}),a.a.createElement("span",{className:"quantity"},"[",u.quantity,u.hq?a.a.createElement("span",{className:"hq"},"(",u.hq,a.a.createElement("img",{src:"hq-white",alt:"HQ"}),")"):null,"]")))})))}))))};i.a.render(a.a.createElement(N,null),document.getElementById("root"))}},[[11,1,2]]]);